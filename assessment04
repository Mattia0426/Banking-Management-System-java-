import java.util.Scanner;


class Transaction {
    int sourceAccountNumber;
    int destinationAccountNumber;
    double amount;

    public Transaction(int sourceAccountNumber, int destinationAccountNumber, double amount) {
        this.sourceAccountNumber = sourceAccountNumber;
        this.destinationAccountNumber = destinationAccountNumber;
        this.amount = amount;
    }
}

class TransactionNode {
    Transaction data;
    TransactionNode prev, next;

    public TransactionNode(Transaction data) {
        this.data = data;
        this.prev = this.next = null;
    }
}

class DoublyLinkedList {
    TransactionNode head;

    public DoublyLinkedList() {
        this.head = null;
    }

    void addTransaction(Transaction transaction) {
        TransactionNode newNode = new TransactionNode(transaction);
        if (head == null) {
            head = newNode;
        } else {
            newNode.next = head;
            head.prev = newNode;
            head = newNode;
        }
    }

    void displayTransactionHistory() {
        System.out.println("Transaction History:");
        TransactionNode current = head;
        while (current != null) {
            System.out.println("Amount: LKR." + current.data.amount
                    + ", Destination Account: " + current.data.destinationAccountNumber);
            current = current.next;
        }
    }
}
class BankAccount {
    int accountNumber;
    String accountHolderName;
    double balance;

    DoublyLinkedList transactions; // Doubly linked list for transactions

    public BankAccount(int accountNumber, String accountHolderName, double balance) {
        this.accountNumber = accountNumber;
        this.accountHolderName = accountHolderName;
        this.balance = balance;
        this.transactions = new DoublyLinkedList();
    }

    void addTransaction(Transaction transaction) {
        transactions.addTransaction(transaction);
    }

    void displayTransactionHistory() {
        transactions.displayTransactionHistory();
    }
}

class Node {
    BankAccount data;
    Node left, right;

    public Node(BankAccount data) {
        this.data = data;
        left = right = null;
    }
}

class BinarySearchTree {
    Node root;

    BinarySearchTree() {
        root = null;
    }

    void insert(BankAccount data) {
        root = insertRec(root, data);
    }

    Node insertRec(Node root, BankAccount data) {
        if (root == null) {
            root = new Node(data);
            return root;
        }
        if (data.accountNumber < root.data.accountNumber) {
            root.left = insertRec(root.left, data);
        } else if (data.accountNumber > root.data.accountNumber) {
            root.right = insertRec(root.right, data);
        }

        return root;
    }

void displayAccounts(Node root) {
        if (root != null) {
            displayAccounts(root.left);
            System.out.println("Account Number: " + root.data.accountNumber
                    + ", Account Holder Name: " + root.data.accountHolderName
                    + ", Balance: LKR." + root.data.balance);
            displayAccounts(root.right);
        }
    }

    void displayAccountDetails(int accountNumber) {
        displayAccountDetailsRec(root, accountNumber);
    }

    void displayAccountDetailsRec(Node root, int accountNumber) {
        if (root == null) {
            System.out.println("Account not found!");
            return;
        }
        if (root.data.accountNumber == accountNumber) {
            System.out.println("Account Number: " + root.data.accountNumber
                    + ", Account Holder Name: " + root.data.accountHolderName
                    + ", Balance: LKR." + root.data.balance);
        } else if (root.data.accountNumber > accountNumber) {
            displayAccountDetailsRec(root.left, accountNumber);
        } else {
            displayAccountDetailsRec(root.right, accountNumber);
        }
    }

    void depositMoney(int accountNumber, double amount) {
        root = depositMoneyRec(root, accountNumber, amount);
    }

    Node depositMoneyRec(Node root, int accountNumber, double amount) {
        if (root == null) {
            System.out.println("Account not found!");
            return root;
        }
        if (root.data.accountNumber == accountNumber) {
            root.data.balance += amount;
            System.out.println("Deposit successful! New balance: LKR." + root.data.balance);
        } else if (root.data.accountNumber > accountNumber) {
            root.left = depositMoneyRec(root.left, accountNumber, amount);
        } else {
            root.right = depositMoneyRec(root.right, accountNumber, amount);
        }
        return root;
    }

    void withdrawMoney(int accountNumber, double amount) {
        root = withdrawMoneyRec(root, accountNumber, amount);
    }

    Node withdrawMoneyRec(Node root, int accountNumber, double amount) {
        if (root == null) {
            System.out.println("Account not found!");
            return root;
        }
        if (root.data.accountNumber == accountNumber) {
            if (root.data.balance >= amount) {
                root.data.balance -= amount;
                System.out.println("Withdrawal successful! New balance: LKR." + root.data.balance);
            } else {
                System.out.println("Insufficient funds!");
            }
        } else if (root.data.accountNumber > accountNumber) {
            root.left = withdrawMoneyRec(root.left, accountNumber, amount);
        } else {
            root.right = withdrawMoneyRec(root.right, accountNumber, amount);
        }
        return root;
    }

    Node findAccount(Node root, int accountNumber) {
        if (root == null || root.data.accountNumber == accountNumber) {
            return root;
        }
        if (root.data.accountNumber > accountNumber) {
            return findAccount(root.left, accountNumber);
        }
        return findAccount(root.right, accountNumber);
    }

    void domesticTransaction(int sourceAccountNumber, int destinationAccountNumber, double amount) {
        Node sourceAccountNode = findAccount(root, sourceAccountNumber);
        Node destinationAccountNode = findAccount(root, destinationAccountNumber);

        if (sourceAccountNode != null && destinationAccountNode != null) {
            if (sourceAccountNode.data.balance >= amount) {
                sourceAccountNode.data.balance -= amount;
                destinationAccountNode.data.balance += amount;

                Transaction transaction = new Transaction(sourceAccountNumber, destinationAccountNumber, amount);
                sourceAccountNode.data.addTransaction(transaction);

                System.out.println("Transaction successful!");
            } else {
                System.out.println("Insufficient funds in Account " + sourceAccountNumber + " for the transaction.");
            }
        } else {
            System.out.println("One or both accounts not found!");
        }
    }
___________________________________________________________________________________________
